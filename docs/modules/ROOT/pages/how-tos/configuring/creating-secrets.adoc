# Using Secrets in Konflux Pipelines

## Introduction
Secrets are used to securely store sensitive information like API tokens, passwords, and other credentials in your CI/CD pipelines.

## Types of Secrets
- **Task Input Secrets**: Used for tasks that require specific secrets to function properly.
- **Registry Pull Secrets**: Used to pull container images from private registries.
- **Source Control Secrets**: Used to access source control platforms like GitLab or GitHub.

## Creating Secrets
### Task Input Secrets
To create a key/value secret in Konflux:
1. Navigate to the **Secrets** page.
2. Click **Add secret**.
3. Select **Key/value secret**.
4. Enter a unique name for your secret.
5. Add the key/value pairs as required.

### Registry Pull Secrets
To create an image pull secret:
1. Obtain the username and password for the container registry.
2. Navigate to the **Secrets** page.
3. Click **Add secret**.
4. Select **Image pull secret**.
5. Enter the registry server address, username, and password.

### Source Control Secrets
To create a secret for accessing GitLab repositories:
1. Create a Project Access Token in GitLab.
2. Use the following YAML to create the secret:
   ```yaml
   apiVersion: v1
   kind: Secret
   metadata:
     name: pipelines-as-code-secret
     namespace: <YOUR NAMESPACE>
     labels:
       appstudio.redhat.com/credentials: scm
       appstudio.redhat.com/scm.host: gitlab.com
   type: kubernetes.io/basic-auth
   stringData:
     password: <PROJECT ACCESS TOKEN>
Using Secrets in Pipeline YAML
Referencing Secrets in Tasks
To reference a secret in a task, use the valueFrom field with secretKeyRef:

yaml
Copy
apiVersion: tekton.dev/v1beta1
kind: TaskRun
metadata:
  name: sast-snyk-check
spec:
  taskRef:
    name: sast-snyk-check
  params:
    - name: snyk_token
      valueFrom:
        secretKeyRef:
          name: sast_snyk_task
          key: snyk_token
Best Practices
Security: Always ensure that secrets are stored securely.

Naming Conventions: Use consistent naming conventions for secrets.

Access Control: Limit access to secrets to only those who need them.

Troubleshooting
Common Issues
Secrets not being recognized by tasks.

Incorrect secret names or keys.

Debugging Tips
Check the secret name and key in the pipeline YAML.

Verify that the secret exists in the correct namespace.

Additional Resources
Konflux GitHub repository

Tekton documentation

GitLab Project Access Tokens

Conclusion
Using secrets correctly in your pipelines is crucial for security and functionality. Follow best practices and refer to the documentation for more details.